<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kingdom Connection</title>
    
    <!-- Web App Manifest -->
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIktpbmdkb20gQ29ubmVjdGlvbiIsCiAgInNob3J0X25hbWUiOiAiS2luZ2RvbSIsCiAgImRlc2NyaXB0aW9uIjogIkRlZXBlbiB5b3VyIHJlbGF0aW9uc2hpcCB0aHJvdWdoIG1lYW5pbmdmdWwgY29udmVyc2F0aW9ucyBhbmQgc2hhcmVkIGZhaXRoIiwKICAic3RhcnRfdXJsIjogIi8iLAogICJkaXNwbGF5IjogInN0YW5kYWxvbmUiLAogICJiYWNrZ3JvdW5kX2NvbG9yIjogIiNmYWZhZmEiLAogICJ0aGVtZV9jb2xvciI6ICIjNjY3ZWVhIiwKICAiaWNvbnMiOiBbCiAgICB7CiAgICAgICJzcmMiOiAiZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxQSE4yWnlCM2FXUjBhRDBpTVRJNElpQm9aV2xuYUhROUlqRXlPQ0lnZG1sbGQwSnZlRDBpTUNBd0lERXlPQ0F4TWpnaUlIaHRiRzV6UFNKb2RIUndPaTh2ZDNkM0xuY3pMbTl5Wnk4eU1EQXdMM04yWnlJK1BHUmxabk0rUEhkcFpHVjBhRDBpTVRJNElpQm9aV2xuYUhROUlqRXlPQ0lnYVdROUlqQWlMejQ4TDJSbFpuTStQR2RzYVc1bFlYSkhabUZrYVdWdWRDQnBaRDBpWjNKaFpHbGxiblFpUGp4emRHOXdJRzltWm5ObGREMGlNQ1VpSUhOMGIzQXRZMjlzYjNJOUlpTTJOamRsWldFaUx6NDhjM1J2Y0NCdlptWnpaWFE5SWpFd01DVWlJSE4wYjNBdFkyOXNiM0k5SWlNM05qUmlZVElpTHo0OEwyZHNhVzVsWVhKSFptRmthV1Z1ZEQ0OGNtVmpkQ0IzYVdSMGFEMGlPREFpSUdobGFXZG9kRDBpT0RBaUlIZzlJakkwSWlCNVBTSXlOQ0lnY25nOUlqSXdJaUJtYVd4c1BTSjFjbXdvSTJkeVlXUnBaVzUwS1NJdkBqeDBaWGgwSUhnOUlqWTBJaUI1UFNJMk5DSWdabWxzYkQwaWQyaHBkR1VpSUdadmJuUXRjMmw2WlQwaU5EQnFlQ0lnWm05dWRDMTNaV2xuYUhROUlqWXdNQ0lnZEdWNGRDMWhibU5vYjNJOUltMXBaR1JzWlNJK01qVXVNVHd2ZEdWNGRENDhMM04yWno0PSIsCiAgICAgICJzaXplcyI6ICIxMjh4MTI4IiwKIAgICAgICJ0eXBlIjogImltYWdlL3N2Zyt4bWwiCiAgICB9LAogICAgewogICAgICAic3JjIjogImRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5QjNhV1IwYUQwaU5URXlJaUJvWldsbmFIUTlJalV4TWlJZ2RtbGxkMEp2ZUQwaU1DQXdJRFV4TWlBMU1USWlJSGh0Ykc1elBTSm9kSFJ3T2k4dmQzZDNMbmN6TG05eVp5OHlNREF3TDNOMlp5SStQR1JsWm5NK1BIZHBaSFJvUFNJMU1USWlJR2hsYVdkb2REMGlOVEV5SWlCcFpEMGlNQ0lnTHo0OEwyUmxabk0rUEdkc2FXNWxZWEpIWm1Ga2FXVnVkQ0JwWkQwaVozSmhaR2xsYm5RaVBqeHpkRzl3SUc5bVpuTmxkRDBpTUNVaUlITjBiM0F0WTI5c2IzSTlJaU0yTmpkbFpXRWlMejQ4YzNSdmNDQnZabVp6WlhROUlqRXdNQ1VpSUhOMGIzQXRZMjlzYjNJOUlpTTNOalJpWVRJaUx6NDhMMmRzYVc1bFlYSkhaV0ZrYVdWdWRENDhjbVZqZENCM2FXUjBhRDBpTXpJd0lpQm9aV2xuYUhROUlqTXlNQ0lnZUQwaU9UWWlJSGs5SWprMklpQnllRDBpT0RBaUlHWnBiR3c5SW5WeWJDZ2paMkpoWkdsbGJuUXBJaTgrUEhSbGVIUWdlRDBpTWpVMklpQjVQU0l5TlRZaUlHWnBiR3c5SW5kb2FYUmxJaUJtYjI1MExYTnBlbVU5SWpFMk1IQjRJaUJtYjI1MExYZGxhV2RvZEQwaU5qQXdJaUIwWlhoMExXRnVZMmh2Y2owaWJXbGtaR3hsUGpFd01TNDJQQzkwWlhoMFBqd3ZjM1puUGc9PSIsCiAgICAgICJzaXplcyI6ICI1MTJ4NTEyIiwKICAICAgICJ0eXBlIjogImltYWdlL3N2Zyt4bWwiCiAgICB9CiAgXQp9">
    
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Kingdom Connection">
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTgwIiBoZWlnaHQ9IjE4MCIgdmlld0JveD0iMCAwIDE4MCAxODAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PGxpbmVhckdyYWRpZW50IGlkPSJncmFkaWVudCI+PHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iIzY2N2VlYSIvPjxzdG9wIG9mZnNldD0iMTAwJSIgc3RvcC1jb2xvcj0iIzc2NGJhMiIvPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxyZWN0IHdpZHRoPSIxODAiIGhlaWdodD0iMTgwIiByeD0iNDAiIGZpbGw9InVybCgjZ3JhZGllbnQpIi8+PHRleHQgeD0iOTAiIHk9IjEwNSIgZmlsbD0id2hpdGUiIGZvbnQtc2l6ZT0iODBweCIgZm9udC13ZWlnaHQ9IjYwMCIgdGV4dC1hbmNob3I9Im1pZGRsZSI+üíïPC90ZXh0Pjwvc3ZnPg==">
    
    <!-- Standard favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZGVmcz48bGluZWFyR3JhZGllbnQgaWQ9ImdyYWRpZW50Ij48c3RvcCBvZmZzZXQ9IjAlIiBzdG9wLWNvbG9yPSIjNjY3ZWVhIi8+PHN0b3Agb2Zmc2V0PSIxMDAlIiBzdG9wLWNvbG9yPSIjNzY0YmEyIi8+PC9saW5lYXJHcmFkaWVudD48L2RlZnM+PHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiByeD0iOCIgZmlsbD0idXJsKCNncmFkaWVudCkiLz48dGV4dCB4PSIxNiIgeT0iMjIiIGZpbGw9IndoaXRlIiBmb250LXNpemU9IjE4cHgiIGZvbnQtd2VpZ2h0PSI2MDAiIHRleHQtYW5jaG9yPSJtaWRkbGUiPjI1LjE8L3RleHQ+PC9zdmc+">
    
    <!-- Android Chrome -->
    <meta name="theme-color" content="#667eea">
    <meta name="mobile-web-app-capable" content="yes">
    <style>
        body {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #fafafa;
            min-height: 100%;
            color: #1a1a1a;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }

        html {
            height: 100%;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100%;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            background: #ffffff;
            padding: 40px 30px;
            border-radius: 16px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
            border: 1px solid #f0f0f0;
            position: relative;
        }

        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
        }

        .logo {
            width: 80px;
            height: 80px;
            border-radius: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            color: white;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
            overflow: hidden;
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 20px;
        }

        .header h1 {
            color: #1a1a1a;
            margin: 0 0 12px 0;
            font-size: 2.25rem;
            font-weight: 600;
            letter-spacing: -0.025em;
        }

        .header p {
            color: #6b7280;
            font-size: 1rem;
            margin: 0;
            font-weight: 400;
        }

        .mode-selector {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .mode-btn {
            background: #ffffff;
            border: 1px solid #e5e7eb;
            padding: 20px 24px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 500;
            color: #374151;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            transition: all 0.2s ease;
            min-width: 200px;
        }

        .mode-btn:hover {
            border-color: #d1d5db;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
        }

        .mode-btn.active {
            background: #1a1a1a;
            color: #ffffff;
            border-color: #1a1a1a;
        }

        .btn {
            background: #1a1a1a;
            color: #ffffff;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.2s ease;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .btn:hover {
            background: #374151;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
        }

        .btn-secondary {
            background: #ffffff;
            color: #374151;
            border: 1px solid #e5e7eb;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .btn-secondary:hover {
            background: #f9fafb;
            border-color: #d1d5db;
        }

        .hidden {
            display: none;
        }

        .login-container {
            max-width: 400px;
            margin: 0 auto;
            background: #ffffff;
            border-radius: 12px;
            padding: 40px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
            border: 1px solid #f0f0f0;
            text-align: center;
        }

        .login-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .form-group {
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #374151;
            font-weight: 500;
            font-size: 0.875rem;
        }

        .form-group input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            font-size: 0.875rem;
            color: #1a1a1a;
            box-sizing: border-box;
            transition: all 0.2s ease;
        }

        .form-group input:focus {
            outline: none;
            border-color: #9ca3af;
            box-shadow: 0 0 0 3px rgba(156, 163, 175, 0.1);
        }

        .profile-pic-upload {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .profile-pic-preview {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: #f9fafb;
            border: 2px solid #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2em;
            color: #9ca3af;
            overflow: hidden;
        }

        .profile-pic-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .file-input-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
        }

        .file-input-wrapper input[type=file] {
            position: absolute;
            left: -9999px;
        }

        .file-input-label {
            background: #f9fafb;
            color: #374151;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            border: 1px solid #e5e7eb;
            transition: all 0.2s ease;
        }

        .file-input-label:hover {
            background: #f3f4f6;
            border-color: #d1d5db;
        }

        .user-profile {
            position: fixed;
            top: 20px;
            right: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            background: #ffffff;
            padding: 12px 16px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
            border: 1px solid #f0f0f0;
            z-index: 1000;
        }

        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: #f9fafb;
            border: 2px solid #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1em;
            color: #9ca3af;
            overflow: hidden;
        }

        .user-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .user-name {
            color: #374151;
            font-weight: 500;
            font-size: 0.875rem;
        }

        .logout-btn {
            background: none;
            border: none;
            color: #9ca3af;
            cursor: pointer;
            font-size: 0.75rem;
            padding: 4px 8px;
            margin-left: 4px;
            border-radius: 4px;
            transition: all 0.2s ease;
        }

        .logout-btn:hover {
            color: #374151;
            background: #f9fafb;
        }

        .connection-status {
            background: #ffffff;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 20px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
            border: 1px solid #f0f0f0;
        }

        .connection-code {
            background: #1a1a1a;
            color: white;
            padding: 16px 24px;
            border-radius: 8px;
            font-size: 1.25rem;
            font-weight: 600;
            letter-spacing: 2px;
            margin: 15px 0;
            display: inline-block;
            font-family: 'Inter', monospace;
        }

        .journal-container {
            max-width: 800px;
            margin: 0 auto;
        }

        .journal-header {
            text-align: center;
            margin-bottom: 40px;
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .journal-header h2 {
            color: #4a5568;
            margin: 0 0 10px 0;
            font-size: 2em;
            font-weight: 400;
        }

        .journal-header p {
            color: #718096;
            margin: 0;
            font-size: 1.1em;
        }

        .journal-card {
            background: #ffffff;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            border: 1px solid #f3f4f6;
        }

        .journal-card h3 {
            color: #1a1a1a;
            margin: 0 0 16px 0;
            font-size: 1.25rem;
            font-weight: 600;
        }

        .question-category-badge {
            display: inline-block;
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 600;
            margin-bottom: 15px;
            border: 2px solid rgba(102, 126, 234, 0.2);
        }

        .daily-question {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            font-size: 1.1em;
            line-height: 1.6;
            margin-bottom: 15px;
            font-style: italic;
        }

        .reflection-areas {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .partner-reflection {
            background: #ffffff;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
            border: 1px solid #f3f4f6;
        }

        .partner-reflection h4 {
            color: #374151;
            margin: 0 0 15px 0;
            font-size: 1rem;
            font-weight: 500;
        }

        .partner-reflection textarea {
            width: 100%;
            min-height: 120px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 16px;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            font-size: 0.875rem;
            color: #1a1a1a;
            resize: vertical;
            box-sizing: border-box;
            transition: all 0.2s ease;
            line-height: 1.5;
        }

        .partner-reflection textarea:focus {
            outline: none;
            border-color: #9ca3af;
            box-shadow: 0 0 0 3px rgba(156, 163, 175, 0.1);
        }

        .partner-profile {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .partner-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #f9fafb;
            border: 2px solid #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            color: #9ca3af;
            overflow: hidden;
            flex-shrink: 0;
        }

        .partner-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .partner-info h4 {
            margin: 0;
            color: #374151;
            font-size: 1rem;
            font-weight: 500;
        }

        .journal-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .date-night-card {
            background: #ffffff;
            border-radius: 16px;
            padding: 40px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            margin-bottom: 30px;
            border: 1px solid #f0f0f0;
            position: relative;
            overflow: hidden;
        }

        .card-number {
            position: absolute;
            top: 20px;
            right: 24px;
            background: #1a1a1a;
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .card-question {
            font-size: 1.25rem;
            color: #1a1a1a;
            line-height: 1.6;
            margin: 20px 0 40px 0;
            font-weight: 500;
            position: relative;
            z-index: 1;
        }

        .card-controls {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
            position: relative;
            z-index: 1;
        }

        .progress-indicator {
            text-align: center;
            margin-bottom: 20px;
            color: #6b7280;
            font-size: 1.1em;
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .mode-btn {
                min-width: 150px;
                padding: 15px 20px;
            }
            
            .date-night-card {
                padding: 25px;
            }
            
            .card-question {
                font-size: 1.1em;
            }

            .reflection-areas {
                grid-template-columns: 1fr;
            }

            .journal-header h2 {
                font-size: 1.6em;
            }

            .journal-card {
                padding: 20px;
            }

            .user-profile {
                position: relative;
                top: auto;
                right: auto;
                margin-bottom: 20px;
                justify-content: center;
            }

            .login-container {
                padding: 30px 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- User Profile (shown when logged in) -->
        <div id="userProfile" class="user-profile hidden">
            <div class="user-avatar" id="userAvatar">üë§</div>
            <span class="user-name" id="userName"></span>
            <button class="logout-btn" onclick="logout()">Logout</button>
        </div>

        <!-- Login/Signup View -->
        <div id="loginView" class="login-container">
            <div class="logo-container">
                <div class="logo" id="appLogo">üíï</div>
            </div>
            <h2 style="color: #4a5568; margin-bottom: 30px;">Welcome to Kingdom Connection</h2>
            
            <form id="loginForm" onsubmit="handleLogin(event)">
                <div class="login-form">
                    <div class="form-group">
                        <label for="loginEmail">Email</label>
                        <input type="email" id="loginEmail" placeholder="Enter your email" required>
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">Password</label>
                        <input type="password" id="loginPassword" placeholder="Enter your password" required>
                    </div>
                    <button type="submit" class="btn">Sign In</button>
                    <button type="button" class="btn btn-secondary" onclick="showSignup()">Create Account</button>
                    <div style="text-align: center; margin-top: 15px;">
                        <button type="button" onclick="showForgotPassword()" style="background: none; border: none; color: #667eea; text-decoration: underline; cursor: pointer; font-size: 0.875rem;">Forgot Password?</button>
                    </div>
                </div>
            </form>

            <form id="signupForm" class="hidden" onsubmit="handleSignup(event)">
                <div class="login-form">
                    <div class="form-group">
                        <label for="signupName">Your Name</label>
                        <input type="text" id="signupName" placeholder="Enter your name" required>
                    </div>
                    <div class="form-group">
                        <label for="signupEmail">Email</label>
                        <input type="email" id="signupEmail" placeholder="Enter your email" required>
                    </div>
                    <div class="form-group">
                        <label for="signupPassword">Password</label>
                        <input type="password" id="signupPassword" placeholder="Create a password" required minlength="6">
                    </div>
                    <div class="form-group">
                        <label>Profile Picture</label>
                        <div class="profile-pic-upload">
                            <div class="profile-pic-preview" id="profilePreview">üì∑</div>
                            <div class="file-input-wrapper">
                                <input type="file" id="profilePic" accept="image/*" onchange="previewProfilePic(event)">
                                <label for="profilePic" class="file-input-label">Choose Photo</label>
                            </div>
                        </div>
                    </div>
                    <button type="submit" class="btn">Create Account</button>
                    <button type="button" class="btn btn-secondary" onclick="showLogin()">Back to Sign In</button>
                </div>
            </form>

            <div id="forgotPasswordForm" class="hidden">
                <div class="login-form">
                    <h3 style="color: #4a5568; margin-bottom: 20px; text-align: center;">Reset Password</h3>
                    <p style="color: #718096; margin-bottom: 20px; text-align: center; font-size: 0.875rem;">Enter your email and we'll help you reset your password</p>
                    <div class="form-group">
                        <label for="resetEmail">Email</label>
                        <input type="email" id="resetEmail" placeholder="Enter your email">
                    </div>
                    <div id="resetStep2" class="hidden">
                        <div class="form-group">
                            <label for="resetCode">Reset Code</label>
                            <input type="text" id="resetCode" placeholder="Enter the code from your email">
                            <small style="color: #718096; font-size: 0.75rem;">For demo purposes, use code: RESET123</small>
                        </div>
                        <div class="form-group">
                            <label for="newPassword">New Password</label>
                            <input type="password" id="newPassword" placeholder="Enter new password">
                        </div>
                        <div class="form-group">
                            <label for="confirmPassword">Confirm Password</label>
                            <input type="password" id="confirmPassword" placeholder="Confirm new password">
                        </div>
                    </div>
                    <button class="btn" id="resetBtn" onclick="sendResetCode()">Send Reset Code</button>
                    <button class="btn btn-secondary" onclick="showLogin()">Back to Sign In</button>
                </div>
            </div>
        </div>

        <!-- Connection Setup View -->
        <div id="connectionView" class="hidden">
            <div class="header">
                <div class="logo-container">
                    <div class="logo" id="connectionLogo">üíï</div>
                </div>
                <h1>üíï Kingdom Connection</h1>
                <p>Connect with your partner to start your journey together</p>
            </div>

            <div class="connection-status">
                <h3 style="color: #4a5568; margin-bottom: 15px;">Connection Status</h3>
                <div id="connectionContent">
                    <p>Share this code with your partner:</p>
                    <div class="connection-code" id="connectionCode"></div>
                    <p style="color: #718096; font-size: 0.9em;">Or enter your partner's code below:</p>
                    <div style="display: flex; gap: 12px; justify-content: center; margin-top: 15px;">
                        <input type="text" id="partnerCode" placeholder="Enter partner's code" style="padding: 12px 16px; border: 1px solid #e5e7eb; border-radius: 8px; text-align: center; font-size: 0.875rem; letter-spacing: 1px; font-family: 'Inter', monospace; transition: all 0.2s ease;">
                        <button class="btn" onclick="connectWithPartner()">Connect</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main App (shown when connected) -->
        <div id="mainApp" class="hidden">
            <div class="header">
                <div class="logo-container">
                    <div class="logo" id="mainLogo">üíï</div>
                </div>
                <h1>üíï Kingdom Connection</h1>
                <p>Deepen your relationship through meaningful conversations and shared faith</p>
            </div>

            <div id="modeSelector" class="mode-selector">
                <button class="mode-btn active" onclick="showJournal()">
                    üìñ Daily Journal<br>
                    <small>One meaningful question each day</small>
                </button>
                <button class="mode-btn" onclick="showDateNight()">
                    üíù Date Night Cards<br>
                    <small>200 conversation starters</small>
                </button>
                <button class="mode-btn" onclick="showHistory()">
                    üìö Reflection History<br>
                    <small>View and export past entries</small>
                </button>
            </div>

            <div id="journalView" class="hidden">
                <div class="journal-container">
                    <div class="journal-header">
                        <h2>üíï Daily Reflection Journal</h2>
                        <p>Take time to reflect individually, then share your hearts together</p>
                    </div>
                    
                    <div class="journal-card">
                        <h3>üåÖ Today's Question</h3>
                        <p style="color: #718096; margin: 0 0 15px 0; font-size: 0.9rem;" id="todaysDate"></p>
                        <div class="question-category-badge" id="questionCategoryBadge"></div>
                        <div class="daily-question" id="dailyQuestion"></div>
                        <button class="btn btn-secondary" onclick="getNewDailyQuestion()">üé≤ New Question</button>
                    </div>
                    
                    <div class="reflection-areas">
                        <div class="partner-reflection">
                            <div class="partner-profile" id="currentUserProfile">
                                <div class="partner-avatar" id="currentUserAvatar">üë§</div>
                                <div class="partner-info">
                                    <h4 id="currentUserName">Your Reflection</h4>
                                </div>
                            </div>
                            <textarea id="currentUserReflection" placeholder="Take time to reflect on today's question..." oninput="autoSaveReflection()"></textarea>
                        </div>
                        <div class="partner-reflection">
                            <div class="partner-profile" id="partnerProfile">
                                <div class="partner-avatar" id="partnerAvatar">üíï</div>
                                <div class="partner-info">
                                    <h4 id="partnerName">Partner's Reflection</h4>
                                </div>
                            </div>
                            <textarea id="partnerReflection" placeholder="Your partner's reflection will appear here..." readonly></textarea>
                        </div>
                    </div>

                    <div class="journal-controls">
                        <button class="btn" onclick="saveJournalEntry()">üíæ Save Entry</button>
                        <button class="btn btn-secondary" onclick="clearJournal()">üóëÔ∏è Clear All</button>
                    </div>
                </div>
            </div>

            <div id="dateNightView" class="hidden">
                <div class="progress-indicator" id="dateNightProgress"></div>
                <div class="date-night-card">
                    <div class="card-number" id="cardNumber"></div>
                    <div class="card-question" id="dateNightQuestion"></div>
                    <div class="card-controls">
                        <button class="btn btn-secondary" onclick="shuffleDateNight()">üîÄ Shuffle</button>
                        <button class="btn" onclick="nextDateNightCard()">Next Card ‚Üí</button>
                        <button class="btn btn-secondary" onclick="resetDateNight()">‚Üª Reset Deck</button>
                    </div>
                </div>
            </div>

            <div id="historyView" class="hidden">
                <div class="journal-container">
                    <div class="journal-header">
                        <h2>üìö Reflection History</h2>
                        <p>Browse through your journey of growth and connection</p>
                    </div>
                    
                    <div id="historyEntries" class="history-entries">
                        <p style="text-align: center; color: #9ca3af; font-style: italic;">No journal entries yet. Start writing to see your history here!</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const categories = {
            "üåø Spiritual Growth + Faith": [
                "How has God been speaking to your heart this week?",
                "What's a recent way you've seen God answer prayer in your life?",
                "How can we encourage each other to spend more time with God daily?",
                "What is a scripture you want to memorize together this month?",
                "When do you feel closest to God ‚Äî in joy, in struggle, or both?"
            ],
            "üí¨ Emotional Intimacy": [
                "What's one thing I do that makes you feel truly seen and understood?",
                "How can I better support you when you're going through a difficult time?",
                "What's something you've been thinking about that you haven't shared with me yet?",
                "How do you prefer to be comforted when you're feeling sad or overwhelmed?",
                "What's one fear or worry you have that I could help you process?"
            ],
            "üíû Relationship Reflection": [
                "How have we grown as a couple in the past few months?",
                "What's something you've learned about me that surprised you (in a good way)?",
                "How do we bring out the best in each other?",
                "What do you envision our relationship looking like one year from now?",
                "What kind of marriage do you want to build one day?"
            ]
        };

        const dateNightQuestions = [
            "If you could ask God one question about our relationship, what would it be?",
            "What's the most romantic thing someone could do that doesn't cost any money?",
            "How do you think our love story will be different in 10 years?",
            "What's one thing about me that you hope never changes?",
            "If we could serve God together anywhere in the world, where would you choose?"
        ];

        let currentView = 'login';
        let currentDateNightIndex = 0;
        let shuffledDateNightQuestions = [...dateNightQuestions];
        let allQuestions = [];
        let currentDailyQuestion = '';
        let currentQuestionCategory = '';
        let currentUser = null;
        let partnerUser = null;

        // Initialize logo loading
        function initializeLogo() {
            const logoUrl = 'https://raw.githubusercontent.com/chanellejanae/kingdomconnection/main/logo.png';
            
            const logoElements = ['appLogo', 'connectionLogo', 'mainLogo'];
            
            logoElements.forEach(logoId => {
                const logoElement = document.getElementById(logoId);
                if (logoElement) {
                    const img = new Image();
                    img.onload = function() {
                        logoElement.innerHTML = `<img src="${logoUrl}" alt="Kingdom Connection Logo">`;
                    };
                    img.onerror = function() {
                        // Keep the heart emoji as fallback since Canva edit links don't work as direct images
                        logoElement.textContent = 'üíï';
                    };
                    img.src = logoUrl;
                }
            });
        }

        function handleLogin(event) {
            event.preventDefault();
            login();
        }

        function handleSignup(event) {
            event.preventDefault();
            signup();
        }

        function showLogin() {
            document.getElementById('loginForm').classList.remove('hidden');
            document.getElementById('signupForm').classList.add('hidden');
            document.getElementById('forgotPasswordForm').classList.add('hidden');
        }

        function showSignup() {
            document.getElementById('loginForm').classList.add('hidden');
            document.getElementById('signupForm').classList.remove('hidden');
            document.getElementById('forgotPasswordForm').classList.add('hidden');
        }

        function showForgotPassword() {
            document.getElementById('loginForm').classList.add('hidden');
            document.getElementById('signupForm').classList.add('hidden');
            document.getElementById('forgotPasswordForm').classList.remove('hidden');
        }

        function previewProfilePic(event) {
            const file = event.target.files[0];
            const preview = document.getElementById('profilePreview');
            
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    preview.innerHTML = `<img src="${e.target.result}" alt="Profile">`;
                };
                reader.readAsDataURL(file);
            }
        }

        function showMessage(message, type = 'info') {
            const existingMessage = document.querySelector('.message-overlay');
            if (existingMessage) {
                existingMessage.remove();
            }

            const messageOverlay = document.createElement('div');
            messageOverlay.className = 'message-overlay';
            messageOverlay.style.cssText = `
                position: fixed; top: 20px; right: 20px; z-index: 10000;
                background: ${type === 'error' ? '#fed7d7' : type === 'success' ? '#c6f6d5' : '#bee3f8'};
                color: ${type === 'error' ? '#c53030' : type === 'success' ? '#2f855a' : '#2c5282'};
                padding: 15px 20px; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);
                border-left: 4px solid ${type === 'error' ? '#e53e3e' : type === 'success' ? '#38a169' : '#3182ce'};
                max-width: 300px; animation: slideIn 0.3s ease;
            `;
            messageOverlay.innerHTML = `
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span>${type === 'error' ? '‚ö†Ô∏è' : type === 'success' ? '‚úÖ' : '‚ÑπÔ∏è'}</span>
                    <span>${message}</span>
                </div>
            `;

            document.body.appendChild(messageOverlay);

            setTimeout(() => {
                if (messageOverlay.parentNode) {
                    messageOverlay.style.animation = 'slideOut 0.3s ease';
                    setTimeout(() => messageOverlay.remove(), 300);
                }
            }, 4000);
        }

        function login() {
            const email = document.getElementById('loginEmail').value.trim();
            const password = document.getElementById('loginPassword').value;
            
            if (!email || !password) {
                showMessage('Please fill in all fields', 'error');
                return;
            }

            const users = JSON.parse(localStorage.getItem('users') || '{}');
            const user = users[email];
            
            if (user && user.password === password) {
                currentUser = user;
                localStorage.setItem('currentUser', JSON.stringify(user));
                showMessage('Login successful!', 'success');
                setTimeout(() => showConnectionView(), 1000);
            } else {
                showMessage('Invalid email or password', 'error');
            }
        }

        function signup() {
            const name = document.getElementById('signupName').value.trim();
            const email = document.getElementById('signupEmail').value.trim();
            const password = document.getElementById('signupPassword').value;
            
            if (!name || !email || !password) {
                showMessage('Please fill in all required fields', 'error');
                return;
            }

            const users = JSON.parse(localStorage.getItem('users') || '{}');
            if (users[email]) {
                showMessage('An account with this email already exists', 'error');
                return;
            }

            const newConnectionCode = Math.random().toString(36).substring(2, 8).toUpperCase();
            
            const newUser = {
                id: Date.now().toString(),
                name: name,
                email: email,
                password: password,
                connectionCode: newConnectionCode,
                partnerId: null,
                profilePic: null
            };

            users[email] = newUser;
            localStorage.setItem('users', JSON.stringify(users));
            
            currentUser = newUser;
            localStorage.setItem('currentUser', JSON.stringify(newUser));
            showMessage('Account created successfully!', 'success');
            setTimeout(() => showConnectionView(), 1000);
        }

        function showConnectionView() {
            document.getElementById('loginView').classList.add('hidden');
            document.getElementById('connectionView').classList.remove('hidden');
            document.getElementById('userProfile').classList.remove('hidden');
            
            updateUserProfile();
            
            if (currentUser.partnerId) {
                loadPartnerAndShowApp();
            } else {
                document.getElementById('connectionCode').textContent = currentUser.connectionCode;
            }
        }

        function updateUserProfile() {
            document.getElementById('userName').textContent = currentUser.name;
            const userAvatar = document.getElementById('userAvatar');
            
            if (currentUser.profilePic) {
                userAvatar.innerHTML = `<img src="${currentUser.profilePic}" alt="${currentUser.name}">`;
            } else {
                userAvatar.textContent = currentUser.name.charAt(0).toUpperCase();
            }
        }

        function connectWithPartner() {
            const partnerCode = document.getElementById('partnerCode').value.toUpperCase();
            
            if (!partnerCode) {
                showMessage('Please enter your partner\'s code', 'error');
                return;
            }

            showMessage('Connected successfully!', 'success');
            setTimeout(() => showMainApp(), 1000);
        }

        function loadPartnerAndShowApp() {
            showMainApp();
        }

        function showMainApp() {
            document.getElementById('connectionView').classList.add('hidden');
            document.getElementById('mainApp').classList.remove('hidden');
            
            initializeJournal();
            showJournal();
        }

        function logout() {
            localStorage.removeItem('currentUser');
            currentUser = null;
            partnerUser = null;
            
            document.getElementById('userProfile').classList.add('hidden');
            document.getElementById('connectionView').classList.add('hidden');
            document.getElementById('mainApp').classList.add('hidden');
            document.getElementById('loginView').classList.remove('hidden');
            
            document.getElementById('loginEmail').value = '';
            document.getElementById('loginPassword').value = '';
            showLogin();
            
            showMessage('Logged out successfully', 'success');
        }

        function initializeQuestions() {
            allQuestions = [];
            for (let category in categories) {
                categories[category].forEach(question => {
                    allQuestions.push({ category, question });
                });
            }
        }

        function initializeJournal() {
            getNewDailyQuestion();
            loadJournalEntries();
        }

        function getNewDailyQuestion() {
            if (allQuestions.length === 0) {
                initializeQuestions();
            }
            
            const randomIndex = Math.floor(Math.random() * allQuestions.length);
            const selectedQuestion = allQuestions[randomIndex];
            
            currentDailyQuestion = selectedQuestion.question;
            currentQuestionCategory = selectedQuestion.category;
            
            document.getElementById('dailyQuestion').textContent = currentDailyQuestion;
            document.getElementById('questionCategoryBadge').textContent = currentQuestionCategory;
        }

        function autoSaveReflection() {
            // Auto-save functionality
        }

        function saveJournalEntry() {
            const today = new Date().toISOString().split('T')[0];
            const entry = {
                date: today,
                question: currentDailyQuestion,
                category: currentQuestionCategory,
                currentUserReflection: document.getElementById('currentUserReflection').value
            };
            
            const entries = JSON.parse(localStorage.getItem('journalEntries') || '{}');
            entries[today] = entry;
            localStorage.setItem('journalEntries', JSON.stringify(entries));
            
            showMessage('Journal entry saved!', 'success');
        }

        function clearJournal() {
            document.getElementById('currentUserReflection').value = '';
            showMessage('Journal cleared', 'info');
        }

        function loadJournalEntries() {
            const today = new Date().toISOString().split('T')[0];
            const entries = JSON.parse(localStorage.getItem('journalEntries') || '{}');
            const todayEntry = entries[today];
            
            if (todayEntry) {
                document.getElementById('currentUserReflection').value = todayEntry.currentUserReflection || '';
                
                if (todayEntry.question) {
                    currentDailyQuestion = todayEntry.question;
                    currentQuestionCategory = todayEntry.category;
                    document.getElementById('dailyQuestion').textContent = currentDailyQuestion;
                    document.getElementById('questionCategoryBadge').textContent = currentQuestionCategory;
                }
            }
        }

        function showJournal() {
            setActiveMode('journal');
            document.getElementById('journalView').classList.remove('hidden');
            document.getElementById('dateNightView').classList.add('hidden');
            document.getElementById('historyView').classList.add('hidden');
        }

        function showDateNight() {
            setActiveMode('dateNight');
            document.getElementById('journalView').classList.add('hidden');
            document.getElementById('dateNightView').classList.remove('hidden');
            document.getElementById('historyView').classList.add('hidden');
            
            if (currentDateNightIndex === 0) {
                displayDateNightCard();
            }
        }

        function showHistory() {
            setActiveMode('history');
            document.getElementById('journalView').classList.add('hidden');
            document.getElementById('dateNightView').classList.add('hidden');
            document.getElementById('historyView').classList.remove('hidden');
        }

        function setActiveMode(mode) {
            document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
            
            if (mode === 'journal') {
                document.querySelector('.mode-btn').classList.add('active');
            } else if (mode === 'dateNight') {
                document.querySelectorAll('.mode-btn')[1].classList.add('active');
            } else if (mode === 'history') {
                document.querySelectorAll('.mode-btn')[2].classList.add('active');
            }
        }

        function displayDateNightCard() {
            document.getElementById('dateNightQuestion').textContent = shuffledDateNightQuestions[currentDateNightIndex];
            document.getElementById('cardNumber').textContent = `${currentDateNightIndex + 1} / ${shuffledDateNightQuestions.length}`;
            document.getElementById('dateNightProgress').textContent = `Card ${currentDateNightIndex + 1} of ${shuffledDateNightQuestions.length}`;
        }

        function nextDateNightCard() {
            currentDateNightIndex = (currentDateNightIndex + 1) % shuffledDateNightQuestions.length;
            displayDateNightCard();
        }

        function shuffleDateNight() {
            shuffledDateNightQuestions = [...dateNightQuestions].sort(() => Math.random() - 0.5);
            currentDateNightIndex = 0;
            displayDateNightCard();
            showMessage('Cards shuffled!', 'info');
        }

        function resetDateNight() {
            shuffledDateNightQuestions = [...dateNightQuestions];
            currentDateNightIndex = 0;
            displayDateNightCard();
            showMessage('Deck reset to original order', 'info');
        }

        function sendResetCode() {
            showMessage('Reset feature coming soon!', 'info');
        }

        // Initialize app when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initializeLogo();
            
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                showConnectionView();
            }
            
            initializeQuestions();
            shuffleDateNightQuestions = [...dateNightQuestions];
            
            const today = new Date();
            const dateString = today.toLocaleDateString('en-US', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
            const todaysDateElement = document.getElementById('todaysDate');
            if (todaysDateElement) {
                todaysDateElement.textContent = dateString;
            }
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'98f1f11884147adc',t:'MTc2MDU1ODgzNi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
